<!DOCTYPE html>
<html id="spryker-academy" lang="en-us" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Developing with Spryker|Migration Guides">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0" />
        <meta name="author" content="Spryker Systems GmbH" />
        <meta name="title" content="Spryker Academy" />
        <meta name="msapplication-config" content="/resources/ui/images/favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="/resources/ui/images/favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="/resources/ui/images/favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="/resources/ui/images/favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="/resources/ui/images/favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="/resources/ui/images/favicons/favicon-16x16.png" />
        <!-- Google Tag Manager -->
        <script>/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NP24S2');/*]]>*/</script>
        <!-- End Google Tag Manager --><title>Migration Guide - Multi Currency</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <style>@import url('https://fonts.googleapis.com/css?family=Lato:300,400,400i,900');

</style>
        <link href="/resources/ui/css/academy-ui-typography.css" rel="stylesheet" />
        <link href="/resources/ui/css/academy-ui-app.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../resources/ui/css/academy-ui-typography.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body class="t-base t-base--page js-base-template">
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP24S2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
        </noscript>
        <!-- End Google Tag Manager (noscript) -->
        <div class="t-base__header">
            <header class="o-header">
                <div class="o-header__content g-grid g-grid--container g-grid--middle"><a class="m-logo g-col g-col--sm-10 g-col--lg-2" href="/"><img class="m-logo__image" src="/resources/ui/images/logo.png" alt="Spryker Logo" /></a>
                    <nav class="m-nav-top g-col g-col--sm-2 g-col--lg-10" id="nav-top">
                        <div class="u-is-hidden--sm-xl">
                            <ul class="nocontent menu mc-component" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                            </ul>
                        </div>
                        <div class="u-is-hidden--xl"><a class="m-nav-top__toggler js-base-template__toggler" href="#"><span class="icon icon-bars"></span></a>
                        </div>
                    </nav>
                </div>
            </header>
        </div>
        <div class="t-base__frame">
            <section class="o-search">
                <div class="g-grid g-grid--container">
                    <section class="m-search g-col g-col--sm-12">
                        <form action="/search.html" method="GET">
                            <input class="a-input a-input--expanded m-search__input" placeholder="Search in the Academy..." name="q" />
                            <button class="m-search__submit" type="submit"><span class="icon icon-search"></span>
                            </button>
                        </form>
                    </section>
                </div>
            </section>
            <section class="t-base__widgets g-grid g-grid--container g-grid--middle">
                <section class="m-breadcrumbs g-col g-col--sm-12 g-col--xl-8">
                    <div class="nocontent">
                        <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                        </div>
                    </div>
                </section>
                <div class="g-col g-col--sm-12 g-col--xl-4 u-align-right">
                    <section class="m-widget-toolbar">
                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_topic_toolbar mc-component nocontent">
                            <div class="button-group-container-left">
                                <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                </button>
                                <button class="button needs-pie next-topic-button" title="Navigate next">
                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                </button>
                                <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                </button>
                                <button class="button needs-pie print-button" title="Print">
                                    <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                </button>
                            </div>
                        </div>
                    </section>
                    <div class="m-widget-github js-widget-github"><a class="m-widget-github__link icon icon-github js-widget-github__link" href="https://github.com/spryker/spryker-academy" target="_blank"></a>
                    </div>
                </div>
            </section>
            <main class="t-base__main g-grid g-grid--container">
                <div class="g-col g-col--sm-12 u-is-hidden--xl">
                    <div class="m-accordion js-accordion">
                        <div class="m-accordion__header">
                            <div class="m-accordion__title js-accordion__toggler"><span class="icon icon-ellipsis-v icon--left"></span>
                    Navigation
                </div>
                        </div>
                        <div class="m-accordion__content js-accordion__content">
                            <nav class="m-nav-sidebar" id="nav-sidebar">
                                <ul class="nocontent menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                <div class="t-page-sidebar__content o-content g-col g-col--sm-12 g-col--xl-8 js-anchorer js-highlighter js-widget-copy">
                    <h1>Migration Guide - Multi-Currency</h1>
                    <h2>Migrating System to Multi-Currency</h2>
                    <p>
          This article provides a whole overview of what needs to be done to have the multi-currency feature running in your Spryker shop. The multi-currency feature affects many Spryker modules so we split it into smaller parts.
          Here you will find the information that will help get you started with the multi-currency feature.</p>
                    <p>There is a chance that you already have the multi-currency enabled in some of the modules. In the list below you will find versions of the modules from when it has first been implemented as well as a link to an appropriate migration guide.</p>
                    <p>First run <var>composer update spryker/*</var> to update your all modules to the latest minor version.</p>
                    <ol>
                        <li value="1"><b style="vertical-align: super;"><u>Infrastructure for multi-currency</u>:</b><![CDATA[
				]]><ul><li value="1"><b>Store &gt;= 1.2.*</b> - this is a new module, require it in composer and execute <var>propel install</var> for the new databases.</li><li value="2"><b>Currency &gt;= 3.2.*</b> - see <a href="mg_currency.html" class="MCXref xref">Migration Guide - Currency</a>.</li><li value="3"><b>Money &gt;= 2.3.*</b> - we have added a new form of money collection type, required by ZED money form inputs.</li><li value="4"><b>ZedRequest &gt;= 3.2.*</b> - we have added a new extension point for ZED request to add additional meta data to request <var>\Spryker\Client\Currency\Plugin\ZedRequestMetaDataProviderPlugin</var>, which sends currency with each ZED request.</li></ul></li>
                        <li value="2">The <b style="text-decoration: underline;">Orders</b> now includes currency iso code, which is used when order is displayed to format price. We have changed <var>OrderSaver</var> and how prices are formatted for Order in Yves and Zed:
                <ul><li value="1"><b>Sales &gt;= 8.*</b> - see <a href="mg_sales.html" class="MCXref xref">Migration Guide - Sales</a>.</li><li value="2"><b>Quote &gt;= 1.1.*</b> - stores current currency when quote is persisted.</li></ul></li>
                        <li value="3"><b style="text-decoration: underline;">Discount</b> module has undergone big changes. Specifically, the way fixed discount calculation works has been changed. The way the amount is entered in Zed form has been changed as well (the amount requires currency now). Decision rules that MUST be built with currency/price mode decision rule include:
                <ul><li value="1"><b>Discount &gt;= 5.*</b> - see <a href="mg_discount.html" class="MCXref xref">Migration Guide - Discount</a>.</li><li value="2"><b>Calculation &gt;= 4.2.*</b> - we have changed the way the discount amount is aggregated.</li><li value="3"><b>Cart &gt;= 4.2.*</b> - we have added a new facade method to rebuild cart items when currency is changed. Extension point to watch for cart item rebuild.</li><li value="4"><b>CartCurrencyConnector</b> - new module provides plugin for cart rebuilding,
                <a href="/developing_with_spryker/module_guide/utilities/currency.html">Currency configuration</a>.</li><li value="5"><b>ProductDiscountConnector &gt;= 3.2.*</b> - we have changed the way the net price is assigned.</li><li value="6"><b>ProductLabelDiscountConnector &gt;= 1.2.*</b> - we have changed the way the net price is assigned.</li><li value="7"><b>ShipmentDiscountConnector &gt;= 1.1.*</b> - we have changed the way the net price is assigned.</li></ul></li>
                        <li value="4">For <b style="text-decoration: underline;">Shipment</b>, we have changed the way the default price is assigned (currency-aware). Zed money input form has also been changed to accept multi-currency:
			<ul><li value="1"><b>Shipment &gt;= 6.*</b> - see <a href="mg_shipment.html" class="MCXref xref">Migration Guide - Shipment</a>.</li><li value="2"><b>ShipmentCartConnector</b> - is a new module, which provides plugins for cart to handle cases when currency changed. See <a href="/developing_with_spryker/module_guide/checkout_process/shipment/shipment_overview.html#shipmentc-art-connector-module">Integration guide</a> for more details.</li></ul></li>
                        <li value="5">In <b style="text-decoration: underline;">Products</b>, the way the price is entered in Zed has been changed to support multi-currency, price mode as well as price type variants. We have also changed the way the collector collects prices, the way Elasticsearch exports prices,
              the way the results coming from Elasticsearch are formatted, the way the prices are picked in cart when item is added:
                <ul><li value="1"><b>CatalogPriceProductConnector</b> - we have added new currency aware formatter plugins for formatting prices when reading results from Elasticsearch. See <a href="/developing_with_spryker/module_guide/checkout_process/shipment/shipment_overview.html#shipmentc-art-connector-module">Integration guide</a> for more details.</li><li value="2"><b>Price &gt;= 5.*</b>- see <a href="mg_price.html" class="MCXref xref">Migration Guide - Price</a>.</li><li value="3"><b>PriceProduct</b> - new module handling price product prices. Migration is part of <a href="mg_price.html">Price module migration guide</a>.</li><li value="4"><b>PriceCartConnector &gt;= 4.*</b> -  <a href="mg_price_cart_connector.html" class="MCXref xref">Migration Guide - Price Cart Connector</a> uses the new PriceProduct module.</li><li value="5"><b>PriceDataFeed &gt;= 0.2.*</b> - uses the new PriceProduct module.</li><li value="6"><b>ProductBundle &gt;= 4.*</b> - <a href="mg_product_bundle.html" class="MCXref xref">Migration Guide - Product Bundle</a> uses the new PriceProduct module, the new plugin to watch cart item reload action.</li><li value="7"><b>ProductLabelGui &gt;= 2.*</b> - see <a href="mg_product_label_gui.html" class="MCXref xref">Migration Guide - Product Label GUI</a>.</li><li value="8"><b>ProductManagement &gt;= 0.9.*</b> - see <a href="mg_product_management.html" class="MCXref xref">Migration Guide - ProductManagement</a>. New forms and views have been added.</li><li value="9"><b>ProductRelation &gt;= 2.*</b> - see <a href="mg_product_relation.html" class="MCXref xref">Migration Guide - Product Relation</a>.</li><li value="10"><b>ProductRelationCollector &gt;= 2.*</b> - see <a href="mg_product_relation_collector.html" class="MCXref xref">Migration Guide - Product Relation Collector</a>.</li><li value="11"><b>ProductSetGui &gt;= 2.*</b> - see <a href="mg_product_set_gui.html" class="MCXref xref">Migration Guide - Product Set GUI</a>.</li><li value="12"><b>Wishlist &gt;= 2.*</b> - see <a href="mg_wishlist.html" class="MCXref xref">Migration Guide - Wishlist</a>.</li><li value="13"><b>Search &gt;= 7.0</b> - see <a href="mg_search.html" class="MCXref xref">Migration Guide - Search</a>.</li></ul></li>
                        <li value="6">Regarding the <b style="text-decoration: underline;">Product Options</b>, the way the price is entered in Zed Admin UI has been changed to support multi-currency behavior. Now Collector collects prices by store and cart checkout has been amended to support multi-currency product options.
                <ul><li value="1"><b>ProductOptionCartConnector &gt;= 5.*</b> - see <a href="mg_product_option_cart_connector.html" class="MCXref xref">Migration Guide - Product Option Cart Connector</a>.</li><li value="2"><b>ProductOption &gt;= 6.*</b> - see <a href="mg_product_option.html" class="MCXref xref">Migration Guide - Product Option</a>.</li></ul></li>
                    </ol>
                    <p>

            Some new configuration options have been made for the whole multi-currency feature:

            earlier the default price type was defined in environment configuration like <var>"$config[PriceProductConstants::DEFAULT_PRICE_TYPE] = 'DEFAULT'"</var>, now it's moved to: <var>\Spryker\Shared\PriceProduct\PriceProductConfig::getPriceTypeDefaultName</var>.

            Please note that you might get an exception that constant is not found - you can safely remove it, unless you used it in your code. In this case replace <var>"\Spryker\Zed\PriceProduct\Business\PriceProductFacade::getDefaultPriceTypeName"</var> or <var>"\Spryker\Client\PriceProduct\PriceProductClient::getPriceTypeDefaultName"</var> accordingly.

            Default price mode is defined in <var>"\Spryker\Shared\Price\PriceConfig::getDefaultPriceMode"</var>.
</p>
                    <p>
            Default currency is defined based on <var>config/Shared/stores.php</var>, array key <var>'currencyIsoCodes'</var> will be the first item in the list.
</p>
                    <p>&#160;</p>
                    <p><b>See also:</b>
                    </p>
                    <ul>
                        <li value="1"><a href="mg_price.html">Learn how to migrate Price</a>
                        </li>
                        <li value="2"><a href="mg_currency.html">Learn how to migrate Currency</a>
                        </li>
                        <li value="3"><a href="mg_sales.html">Learn how to migrate Sales</a>
                        </li>
                        <li value="4"><a href="mg_discount.html">Learn how to migrate Discount</a>
                        </li>
                        <li value="5"><a href="mg_shipment.html">Learn how to migrate Shipment</a>
                        </li>
                    </ul>
                    <p>&#160;</p>
                    <p><i>Last review date: Nov. 23rd, 2017 </i>
                    </p>
                    <p><![CDATA[
    ]]></p>
                </div>
                <div class="t-page-sidebar__sidebar g-col g-col--sm-12 g-col--xl-4 u-is-hidden--sm-xl">
                    <section class="a-box a-box--shadow">
                        <nav class="m-nav-sidebar" id="nav-sidebar">
                            <ul class="nocontent menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                            </ul>
                        </nav>
                    </section>
                </div>
            </main>
            <div class="t-base__footer">
                <footer class="o-footer g-grid g-grid--middle">
                    <nav class="g-grid g-grid--container g-grid--center"><a class="o-footer__link" href="https://spryker.com/privacy-policy" target="_blank">Privacy policy</a><a class="o-footer__link" href="https://spryker.com/partneragb" target="_blank">AGB Partnerprogram</a><a class="o-footer__link" href="https://spryker.com/impressum" target="_blank">Impressum</a>
                    </nav>
                </footer>
            </div><a class="a-scroll-top js-scroll-top" href="#"><span class="a-scroll-top__icon icon icon-chevron-up"></span></a>
            <div class="t-base__overlay js-base-template__toggler">
            </div>
        </div>
        <div class="t-base__off">
            <section class="o-off-canvas">
                <nav class="m-nav-mobile" id="nav-mobile">
                    <ul class="nocontent menu mc-component" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                    </ul>
                </nav>
            </section>
        </div>
        <script src="/resources/ui/js/academy-ui-manifest.js">
        </script>
        <script src="/resources/ui/js/academy-ui-vendor.js">
        </script>
        <script src="/resources/ui/js/academy-ui-app.js">
        </script>
    </body>
</html>